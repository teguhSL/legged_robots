function A_p = eval_A_p(q_p)
[m1, m2, m3, l1, l2, l3, g] = set_parameters();
m = m1;
q1_p = q_p(1);
q2_p = q_p(2);
q3_p = q_p(3);
t2 = l1.^2;
t3 = -q2_p;
t4 = -q3_p;
t5 = q1_p+t3;
t6 = q1_p+t4;
t7 = cos(t5);
t8 = cos(t6);
t9 = (l1.*l2.*m.*t7)./2.0;
t10 = (l1.*l3.*m3.*t8)./2.0;
t11 = -t10;
A_p = reshape([t9+t11-m.*t2.*(5.0./4.0)-m3.*t2,t9,t11,l2.*m.*(l2-l1.*t7.*2.0).*(-1.0./4.0),l2.^2.*m.*(-1.0./4.0),0.0,l3.*m3.*(l3+l1.*t8.*2.0).*(-1.0./4.0),0.0,l3.^2.*m3.*(-1.0./4.0)],[3,3]);

end